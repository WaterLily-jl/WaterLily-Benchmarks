# Automatic profiling

Similarly to benchmarking, profiling is also automated through [`profile.sh`](profile.sh). The main kernels of the solver, generated by [KernelAbstractions.jl](https://github.com/JuliaGPU/KernelAbstractions.jl), are traced using [NVTX.jl](https://github.com/JuliaGPU/NVTX.jl). Traces are introduced in the [`profiling`](https://github.com/WaterLily-jl/WaterLily.jl/tree/profiling) branch of WaterLily.

The `profile.sh` script works with the same arguments as the `benchmark.sh` script, see the main [README.md](README.md) file for a detailed explanation. An additional argument is used here: `--run` (or `-r`). `--run=0` assumes that profiling data is already available in `--data_dir`, and it only post-process those results. `--run=1` runs the actual profiling tests, and `--run=2` runs the tests and then performs the data post-processing.